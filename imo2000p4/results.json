{
  "problem_statement": "IMO 2000 P4: Magician Card Trick",
  "n_cards": 100,
  "analysis": {
    "n=3": {
      "n_cards": 3,
      "total_partitions_checked": 1,
      "valid_count": 6,
      "valid_distributions": [
        {
          "red": [
            1
          ],
          "white": [
            2
          ],
          "blue": [
            3
          ],
          "ranges": {
            "red_white": [
              3,
              3
            ],
            "red_blue": [
              4,
              4
            ],
            "white_blue": [
              5,
              5
            ]
          }
        },
        {
          "red": [
            1
          ],
          "white": [
            3
          ],
          "blue": [
            2
          ],
          "ranges": {
            "red_white": [
              4,
              4
            ],
            "red_blue": [
              3,
              3
            ],
            "white_blue": [
              5,
              5
            ]
          }
        },
        {
          "red": [
            2
          ],
          "white": [
            1
          ],
          "blue": [
            3
          ],
          "ranges": {
            "red_white": [
              3,
              3
            ],
            "red_blue": [
              5,
              5
            ],
            "white_blue": [
              4,
              4
            ]
          }
        },
        {
          "red": [
            2
          ],
          "white": [
            3
          ],
          "blue": [
            1
          ],
          "ranges": {
            "red_white": [
              5,
              5
            ],
            "red_blue": [
              3,
              3
            ],
            "white_blue": [
              4,
              4
            ]
          }
        },
        {
          "red": [
            3
          ],
          "white": [
            1
          ],
          "blue": [
            2
          ],
          "ranges": {
            "red_white": [
              4,
              4
            ],
            "red_blue": [
              5,
              5
            ],
            "white_blue": [
              3,
              3
            ]
          }
        },
        {
          "red": [
            3
          ],
          "white": [
            2
          ],
          "blue": [
            1
          ],
          "ranges": {
            "red_white": [
              5,
              5
            ],
            "red_blue": [
              4,
              4
            ],
            "white_blue": [
              3,
              3
            ]
          }
        }
      ]
    },
    "n=4": {
      "n_cards": 4,
      "total_partitions_checked": 6,
      "valid_count": 12,
      "valid_distributions": [
        {
          "red": [
            1
          ],
          "white": [
            2,
            3
          ],
          "blue": [
            4
          ],
          "ranges": {
            "red_white": [
              3,
              4
            ],
            "red_blue": [
              5,
              5
            ],
            "white_blue": [
              6,
              7
            ]
          }
        },
        {
          "red": [
            1
          ],
          "white": [
            4
          ],
          "blue": [
            2,
            3
          ],
          "ranges": {
            "red_white": [
              5,
              5
            ],
            "red_blue": [
              3,
              4
            ],
            "white_blue": [
              6,
              7
            ]
          }
        },
        {
          "red": [
            2,
            3
          ],
          "white": [
            1
          ],
          "blue": [
            4
          ],
          "ranges": {
            "red_white": [
              3,
              4
            ],
            "red_blue": [
              6,
              7
            ],
            "white_blue": [
              5,
              5
            ]
          }
        },
        {
          "red": [
            2,
            3
          ],
          "white": [
            4
          ],
          "blue": [
            1
          ],
          "ranges": {
            "red_white": [
              6,
              7
            ],
            "red_blue": [
              3,
              4
            ],
            "white_blue": [
              5,
              5
            ]
          }
        },
        {
          "red": [
            4
          ],
          "white": [
            1
          ],
          "blue": [
            2,
            3
          ],
          "ranges": {
            "red_white": [
              5,
              5
            ],
            "red_blue": [
              6,
              7
            ],
            "white_blue": [
              3,
              4
            ]
          }
        },
        {
          "red": [
            4
          ],
          "white": [
            2,
            3
          ],
          "blue": [
            1
          ],
          "ranges": {
            "red_white": [
              6,
              7
            ],
            "red_blue": [
              5,
              5
            ],
            "white_blue": [
              3,
              4
            ]
          }
        },
        {
          "red": [
            2
          ],
          "white": [
            3
          ],
          "blue": [
            1,
            4
          ],
          "ranges": {
            "red_white": [
              5,
              5
            ],
            "red_blue": [
              3,
              6
            ],
            "white_blue": [
              4,
              7
            ]
          }
        },
        {
          "red": [
            2
          ],
          "white": [
            1,
            4
          ],
          "blue": [
            3
          ],
          "ranges": {
            "red_white": [
              3,
              6
            ],
            "red_blue": [
              5,
              5
            ],
            "white_blue": [
              4,
              7
            ]
          }
        },
        {
          "red": [
            3
          ],
          "white": [
            2
          ],
          "blue": [
            1,
            4
          ],
          "ranges": {
            "red_white": [
              5,
              5
            ],
            "red_blue": [
              4,
              7
            ],
            "white_blue": [
              3,
              6
            ]
          }
        },
        {
          "red": [
            3
          ],
          "white": [
            1,
            4
          ],
          "blue": [
            2
          ],
          "ranges": {
            "red_white": [
              4,
              7
            ],
            "red_blue": [
              5,
              5
            ],
            "white_blue": [
              3,
              6
            ]
          }
        },
        {
          "red": [
            1,
            4
          ],
          "white": [
            2
          ],
          "blue": [
            3
          ],
          "ranges": {
            "red_white": [
              3,
              6
            ],
            "red_blue": [
              4,
              7
            ],
            "white_blue": [
              5,
              5
            ]
          }
        },
        {
          "red": [
            1,
            4
          ],
          "white": [
            3
          ],
          "blue": [
            2
          ],
          "ranges": {
            "red_white": [
              4,
              7
            ],
            "red_blue": [
              3,
              6
            ],
            "white_blue": [
              5,
              5
            ]
          }
        }
      ]
    },
    "n=5": {
      "n_cards": 5,
      "total_partitions_checked": 25,
      "valid_count": 12,
      "valid_distributions": [
        {
          "red": [
            1
          ],
          "white": [
            2,
            3,
            4
          ],
          "blue": [
            5
          ],
          "ranges": {
            "red_white": [
              3,
              5
            ],
            "red_blue": [
              6,
              6
            ],
            "white_blue": [
              7,
              9
            ]
          }
        },
        {
          "red": [
            1
          ],
          "white": [
            5
          ],
          "blue": [
            2,
            3,
            4
          ],
          "ranges": {
            "red_white": [
              6,
              6
            ],
            "red_blue": [
              3,
              5
            ],
            "white_blue": [
              7,
              9
            ]
          }
        },
        {
          "red": [
            2,
            3,
            4
          ],
          "white": [
            1
          ],
          "blue": [
            5
          ],
          "ranges": {
            "red_white": [
              3,
              5
            ],
            "red_blue": [
              7,
              9
            ],
            "white_blue": [
              6,
              6
            ]
          }
        },
        {
          "red": [
            2,
            3,
            4
          ],
          "white": [
            5
          ],
          "blue": [
            1
          ],
          "ranges": {
            "red_white": [
              7,
              9
            ],
            "red_blue": [
              3,
              5
            ],
            "white_blue": [
              6,
              6
            ]
          }
        },
        {
          "red": [
            5
          ],
          "white": [
            1
          ],
          "blue": [
            2,
            3,
            4
          ],
          "ranges": {
            "red_white": [
              6,
              6
            ],
            "red_blue": [
              7,
              9
            ],
            "white_blue": [
              3,
              5
            ]
          }
        },
        {
          "red": [
            5
          ],
          "white": [
            2,
            3,
            4
          ],
          "blue": [
            1
          ],
          "ranges": {
            "red_white": [
              7,
              9
            ],
            "red_blue": [
              6,
              6
            ],
            "white_blue": [
              3,
              5
            ]
          }
        },
        {
          "red": [
            3
          ],
          "white": [
            1,
            4
          ],
          "blue": [
            2,
            5
          ],
          "ranges": {
            "red_white": [
              4,
              7
            ],
            "red_blue": [
              5,
              8
            ],
            "white_blue": [
              3,
              9
            ]
          }
        },
        {
          "red": [
            3
          ],
          "white": [
            2,
            5
          ],
          "blue": [
            1,
            4
          ],
          "ranges": {
            "red_white": [
              5,
              8
            ],
            "red_blue": [
              4,
              7
            ],
            "white_blue": [
              3,
              9
            ]
          }
        },
        {
          "red": [
            1,
            4
          ],
          "white": [
            3
          ],
          "blue": [
            2,
            5
          ],
          "ranges": {
            "red_white": [
              4,
              7
            ],
            "red_blue": [
              3,
              9
            ],
            "white_blue": [
              5,
              8
            ]
          }
        },
        {
          "red": [
            1,
            4
          ],
          "white": [
            2,
            5
          ],
          "blue": [
            3
          ],
          "ranges": {
            "red_white": [
              3,
              9
            ],
            "red_blue": [
              4,
              7
            ],
            "white_blue": [
              5,
              8
            ]
          }
        },
        {
          "red": [
            2,
            5
          ],
          "white": [
            3
          ],
          "blue": [
            1,
            4
          ],
          "ranges": {
            "red_white": [
              5,
              8
            ],
            "red_blue": [
              3,
              9
            ],
            "white_blue": [
              4,
              7
            ]
          }
        },
        {
          "red": [
            2,
            5
          ],
          "white": [
            1,
            4
          ],
          "blue": [
            3
          ],
          "ranges": {
            "red_white": [
              3,
              9
            ],
            "red_blue": [
              5,
              8
            ],
            "white_blue": [
              4,
              7
            ]
          }
        }
      ]
    }
  },
  "n_100_solution": {
    "consecutive_valid_distributions": 6,
    "theoretical_upper_bound": 29106,
    "num_split_positions": 4851,
    "example_distributions": [
      {
        "red": [
          1
        ],
        "white": [
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33,
          34,
          35,
          36,
          37,
          38,
          39,
          40,
          41,
          42,
          43,
          44,
          45,
          46,
          47,
          48,
          49,
          50,
          51,
          52,
          53,
          54,
          55,
          56,
          57,
          58,
          59,
          60,
          61,
          62,
          63,
          64,
          65,
          66,
          67,
          68,
          69,
          70,
          71,
          72,
          73,
          74,
          75,
          76,
          77,
          78,
          79,
          80,
          81,
          82,
          83,
          84,
          85,
          86,
          87,
          88,
          89,
          90,
          91,
          92,
          93,
          94,
          95,
          96,
          97,
          98,
          99
        ],
        "blue": [
          100
        ],
        "ranges": {
          "red_white": [
            3,
            100
          ],
          "red_blue": [
            101,
            101
          ],
          "white_blue": [
            102,
            199
          ]
        }
      },
      {
        "red": [
          1
        ],
        "white": [
          100
        ],
        "blue": [
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33,
          34,
          35,
          36,
          37,
          38,
          39,
          40,
          41,
          42,
          43,
          44,
          45,
          46,
          47,
          48,
          49,
          50,
          51,
          52,
          53,
          54,
          55,
          56,
          57,
          58,
          59,
          60,
          61,
          62,
          63,
          64,
          65,
          66,
          67,
          68,
          69,
          70,
          71,
          72,
          73,
          74,
          75,
          76,
          77,
          78,
          79,
          80,
          81,
          82,
          83,
          84,
          85,
          86,
          87,
          88,
          89,
          90,
          91,
          92,
          93,
          94,
          95,
          96,
          97,
          98,
          99
        ],
        "ranges": {
          "red_white": [
            101,
            101
          ],
          "red_blue": [
            3,
            100
          ],
          "white_blue": [
            102,
            199
          ]
        }
      },
      {
        "red": [
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33,
          34,
          35,
          36,
          37,
          38,
          39,
          40,
          41,
          42,
          43,
          44,
          45,
          46,
          47,
          48,
          49,
          50,
          51,
          52,
          53,
          54,
          55,
          56,
          57,
          58,
          59,
          60,
          61,
          62,
          63,
          64,
          65,
          66,
          67,
          68,
          69,
          70,
          71,
          72,
          73,
          74,
          75,
          76,
          77,
          78,
          79,
          80,
          81,
          82,
          83,
          84,
          85,
          86,
          87,
          88,
          89,
          90,
          91,
          92,
          93,
          94,
          95,
          96,
          97,
          98,
          99
        ],
        "white": [
          1
        ],
        "blue": [
          100
        ],
        "ranges": {
          "red_white": [
            3,
            100
          ],
          "red_blue": [
            102,
            199
          ],
          "white_blue": [
            101,
            101
          ]
        }
      },
      {
        "red": [
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33,
          34,
          35,
          36,
          37,
          38,
          39,
          40,
          41,
          42,
          43,
          44,
          45,
          46,
          47,
          48,
          49,
          50,
          51,
          52,
          53,
          54,
          55,
          56,
          57,
          58,
          59,
          60,
          61,
          62,
          63,
          64,
          65,
          66,
          67,
          68,
          69,
          70,
          71,
          72,
          73,
          74,
          75,
          76,
          77,
          78,
          79,
          80,
          81,
          82,
          83,
          84,
          85,
          86,
          87,
          88,
          89,
          90,
          91,
          92,
          93,
          94,
          95,
          96,
          97,
          98,
          99
        ],
        "white": [
          100
        ],
        "blue": [
          1
        ],
        "ranges": {
          "red_white": [
            102,
            199
          ],
          "red_blue": [
            3,
            100
          ],
          "white_blue": [
            101,
            101
          ]
        }
      },
      {
        "red": [
          100
        ],
        "white": [
          1
        ],
        "blue": [
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33,
          34,
          35,
          36,
          37,
          38,
          39,
          40,
          41,
          42,
          43,
          44,
          45,
          46,
          47,
          48,
          49,
          50,
          51,
          52,
          53,
          54,
          55,
          56,
          57,
          58,
          59,
          60,
          61,
          62,
          63,
          64,
          65,
          66,
          67,
          68,
          69,
          70,
          71,
          72,
          73,
          74,
          75,
          76,
          77,
          78,
          79,
          80,
          81,
          82,
          83,
          84,
          85,
          86,
          87,
          88,
          89,
          90,
          91,
          92,
          93,
          94,
          95,
          96,
          97,
          98,
          99
        ],
        "ranges": {
          "red_white": [
            101,
            101
          ],
          "red_blue": [
            102,
            199
          ],
          "white_blue": [
            3,
            100
          ]
        }
      },
      {
        "red": [
          100
        ],
        "white": [
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33,
          34,
          35,
          36,
          37,
          38,
          39,
          40,
          41,
          42,
          43,
          44,
          45,
          46,
          47,
          48,
          49,
          50,
          51,
          52,
          53,
          54,
          55,
          56,
          57,
          58,
          59,
          60,
          61,
          62,
          63,
          64,
          65,
          66,
          67,
          68,
          69,
          70,
          71,
          72,
          73,
          74,
          75,
          76,
          77,
          78,
          79,
          80,
          81,
          82,
          83,
          84,
          85,
          86,
          87,
          88,
          89,
          90,
          91,
          92,
          93,
          94,
          95,
          96,
          97,
          98,
          99
        ],
        "blue": [
          1
        ],
        "ranges": {
          "red_white": [
            102,
            199
          ],
          "red_blue": [
            101,
            101
          ],
          "white_blue": [
            3,
            100
          ]
        }
      }
    ],
    "note": "Only consecutive partitions checked. The answer is 6 based on this pattern, but the actual IMO answer may consider additional constraints."
  },
  "mathematical_insight": {
    "key_observation": "Valid distributions require disjoint sum ranges",
    "pattern": "Cards must be partitioned into consecutive ranges",
    "formula_explanation": "For n cards split at positions k and m (1 <= k < m < n), we get 3 groups: [1..k], [k+1..m], [m+1..n]. There are (n-1) choose 2 ways to choose split points, times 6 permutations of box assignments. But only certain permutations maintain disjoint sum ranges.",
    "expected_answer": "The answer is related to arranging consecutive segments",
    "imo_2000_insight": "The official IMO 2000 P4 answer considers that for the trick to work, one approach is to analyze when consecutive partitions yield disjoint sum ranges. From the examples found: only 6 valid consecutive arrangements exist where one box contains a single extreme card (1 or 100) and the others split the remainder. The actual answer may be different if considering non-consecutive partitions, but the consecutive case provides clear examples and insight into the structure.",
    "pattern_observation": "All 6 valid consecutive distributions have the form: {1 card with value 1 or 100} + {remaining 99 cards split in some way}. This ensures maximum separation between sum ranges."
  },
  "metrics": {
    "runtime_ms": 1285.52,
    "status": "success"
  }
}