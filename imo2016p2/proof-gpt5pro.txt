[
\textbf{Answer: } \boxed{\text{Such a filling exists precisely for }n\equiv 0\pmod{9}.}
]
In other words, the condition is both necessary and sufficient that (n) be a multiple of (9).

We write (A,B,C) also as residues ({0,1,2}) modulo (3) whenever convenient; “one third of the entries are (A,B,C)” along a line (row/column/diagonal) means the multiset of entries on that line contains each of (0,1,2) equally often, i.e. its sum is (0\pmod3) and all three letters appear equally often.

We first prove necessity, then give an explicit construction for all (n\equiv 0\pmod 9).

---

## 1. Necessity: (3\mid n) and in fact (9\mid n)

### (a) (3\mid n)

In every row there must be one third (A), one third (B), one third (C). Hence (3\mid n) is immediate.

So write (n=3m) with (m\in\Bbb N).

### (b) A structural consequence of the diagonal condition

Call a (type–1) diagonal a line of slope (+1) (i.e. (i-j=\text{const})) and a (type–2) diagonal a line of slope (-1) (i.e. (i+j=\text{const})). For (n=3m), the type–1 diagonals whose length is a multiple of 3 are precisely those with (i-j\equiv 0\pmod 3); the type–2 diagonals whose length is a multiple of 3 are precisely those with (i+j\equiv 1\pmod 3).

Partition the (n\times n) board into disjoint (3\times 3) blocks by grouping rows (1\text{–}3), (4\text{–}6), …, and columns (1\text{–}3), (4\text{–}6), … . There are (m\times m) such blocks. Fix one block with top-left corner at ((3r+1,3s+1)) for some (0\le r,s\le m-1).

Inside this block, consider the two block–diagonals
[
D_{+}={(3r+1,3s+1),(3r+2,3s+2),(3r+3,3s+3)},\qquad
D_{-}={(3r+1,3s+3),(3r+2,3s+2),(3r+3,3s+1)}.
]
These are parts of global diagonals with
[
i-j\equiv (3r+1)-(3s+1)\equiv r-s\pmod 3,\qquad
i+j\equiv (3r+1)+(3s+3)\equiv r+s+1\pmod 3.
]
Thus for every block with (r\equiv s\pmod 3), (D_{+}) lies on a type–1 diagonal of total length a multiple of (3) and therefore must contain one (A), one (B), one (C). Likewise, for every block with (r+s\equiv 0\pmod 3), (D_{-}) lies on a type–2 diagonal of total length a multiple of (3) and therefore must also be ({A,B,C}).

Now observe that for any fixed block the congruences (r\equiv s\pmod 3) and (r+s\equiv 0\pmod 3) hold simultaneously **iff** (r\equiv s\equiv 0\pmod 3). Hence **in every block whose block–indices ((r,s)) are both (0\pmod3)** (call these the *distinguished blocks*), *both* block–diagonals (D_{+}) and (D_{-}) contain all three letters.

We now use an elementary (3\times 3) lemma.

> **Lemma (3×3 rainbow–diagonal lemma).**
> In a (3\times 3) array over ({A,B,C}), if both diagonals contain one (A), one (B), one (C), then each of the three rows and each of the three columns also contains one (A), one (B), one (C).

*Proof of lemma.* Suppose the main diagonal entries (top-left to bottom-right) are (X,Y,Z) all distinct and the other diagonal entries (top-right to bottom-left) are (X',Y,Z') all distinct, with the center (Y) common. As the alphabet has size three, we must have ({X,Y,Z}={X',Y,Z'}={A,B,C}). A direct case-check (there are only two possibilities up to renaming letters and swapping the two corner entries on the anti-diagonal) shows that in both cases, forcing both diagonals to be rainbow compels the remaining six entries to complete each row and each column as a permutation of (A,B,C). (Indeed, try to repeat a letter in a row: it immediately blocks completion of the intersecting column because each column must contain three different letters, a contradiction.) (\square)

Applying the lemma to every *distinguished* (3\times 3) block, we conclude:

> **Fact.** In every distinguished (3\times 3) block (i.e. those with block indices ((r,s)\equiv (0,0)\pmod 3)), each of the three rows of the block and each of the three columns of the block contains exactly one (A), one (B), and one (C).

### (c) Forcing (9\mid n)

Focus on a fixed *triple* of consecutive rows forming the top of a distinguished block; say the rows (1,2,3). In each triple of consecutive columns that form the left edge of a distinguished block (i.e. columns (1,2,3); then (10,11,12); then (19,20,21); etc., spaced every (9) columns), the (3\times 3) subarray is distinguished, hence its three columns are all rainbow (by the Fact). Consequently, along the fixed triple of rows (1,2,3), **in each such group of three consecutive columns spaced every (9) columns**, the multiset of letters is exactly ({A,B,C}).

Summing over all such groups across the whole width (n=3m), we see that in the triple of rows (1,2,3) the number of occurrences of (A) equals the number of occurrences of (B) equals the number of occurrences of (C) **if and only if** the number of such groups is a multiple of (3). But the groups are spaced every (9) columns, so the number of groups across (n) columns is (n/9=m/3). Since each of rows (1,2,3) must have exactly (n/3) of each letter, it follows that (m/3) must be an integer; that is, (3\mid m), i.e.
[
9\mid n.
]

This establishes necessity: if a solution exists, then (n) must be a multiple of (9).

*(A symmetric argument works starting with any triple of consecutive rows at the top of a distinguished block; the conclusion is the same.)*

---

## 2. Sufficiency: an explicit construction for all (n\equiv 0\pmod 9)

Let (n=9q) with (q\in\Bbb N). Index rows and columns (1,2,\dots,n). Identify (A,B,C) with residues (0,1,2\pmod3). Define a filling (F:{1,\dots,n}^2\to{0,1,2}) by
[
F(i,j);\equiv; \underbrace{\left\lfloor\frac{i-1}{3}\right\rfloor}_{\text{block index of row }i}
;+; (j-1)\pmod 3.
\tag{1}
]
(Equivalently: within each block of 3 consecutive rows, all three rows are copies of the infinite periodic word (012012\cdots), but the *starting phase* is (0) in the first 3 rows, (1) in the next 3 rows, (2) in the next 3 rows, and then this (0,1,2) pattern of block–phases repeats every (3) blocks; since (n=9q), there are (3q) blocks and exactly (q) blocks of each phase.)

We verify the conditions.

### (i) Rows.

Fix (i). As (j) runs through any consecutive triple (3t+1,3t+2,3t+3), the values
[
F(i,3t+1),,F(i,3t+2),,F(i,3t+3)
]
are (\alpha, \alpha+1, \alpha+2\pmod 3) where (\alpha=\lfloor(i-1)/3\rfloor + 3t) (mod (3)), hence a permutation of (0,1,2). There are (n/3=3q) such triples in the row, so the row contains each of (0,1,2) exactly (n/3) times.

### (ii) Columns.

Fix (j). Partition the rows into consecutive triples (3s+1,3s+2,3s+3). On such a triple we have
[
F(3s+1,j)\equiv s+(j-1),\quad F(3s+2,j)\equiv s+(j-1),\quad F(3s+3,j)\equiv s+(j-1)\pmod 3,
]
and when we pass from the triple (s) to the triple (s+1), the value increases by (1) modulo (3). Since there are (n/3=3q) triples and the triple–phase (s) runs through (0,1,2,0,1,2,\dots) exactly (q) times each (because (n=9q)), each column contains each of (0,1,2) exactly (n/3) times.

### (iii) Type–1 diagonals (slope (+1)).

Along a step ((i,j)\mapsto(i+1,j+1)),
[
F(i+1,j+1)-F(i,j)\equiv
\Big\lfloor\tfrac{i}{3}\Big\rfloor-\Big\lfloor\tfrac{i-1}{3}\Big\rfloor
;+;1\pmod 3.
]
As (i) increases by (1), the floor term jumps by (1) exactly when (i\equiv 0\pmod 3), otherwise it is (0). Thus along any three consecutive cells on a slope-(+1) diagonal, the successive differences are (1,1,1) except at a wrap where they are (2,1,1) or (1,2,1), but in **every** block of 3 consecutive steps the cumulative change mod (3) cycles through all three residues. Concretely, for any three consecutive cells on such a diagonal the triple of values is a permutation of ((x,x+1,x+2)) for some (x). Therefore, *every* slope-(+1) diagonal whose length is divisible by (3) splits into disjoint 3-term blocks, each containing one of each letter; hence the whole diagonal has one third (A), one third (B), one third (C).

(Equivalently: the sequence (F(i,i)) of values on the main diagonal is periodic of period (9) equal to
[
1,2,0,;2,0,1,;0,1,2,
]
and **every** length-3 consecutive window in this period is a permutation of (0,1,2); the same holds for any slope-(+1) diagonal because all such diagonals are translates of the main one.)

### (iv) Type–2 diagonals (slope (-1)).

Along a step ((i,j)\mapsto(i+1,j-1)),
[
F(i+1,j-1)-F(i,j)\equiv
\Big\lfloor\tfrac{i}{3}\Big\rfloor-\Big\lfloor\tfrac{i-1}{3}\Big\rfloor
;-;1\pmod 3.
]
As (i) increases by (1), in any block of three consecutive steps, exactly one step has the floor–increment (1), while the other two have (0). Hence in **every** block of three consecutive cells on a slope-(-1) diagonal, the successive changes are ((0-1), (0-1), (1-1)) in some order, i.e. a permutation of ((-1,-1,0)), and therefore the three values again form a permutation of ((x,x+1,x+2)) for some (x). Thus every slope-(-1) diagonal whose length is divisible by (3) also splits into 3-term blocks each containing one of each letter, and the whole diagonal is equally split among (A,B,C).

(Equivalently: the sequence on the main anti-diagonal is the period–(9) word
[
2,1,0,;0,2,1,;1,0,2,
]
again with every 3-consecutive window equal to ({0,1,2}).)

This completes the verification.

---

## 3. Conclusion

We proved that if such a filling exists then (9\mid n). Conversely, for every (n\equiv 0\pmod 9) the explicit formula ((1)) produces a filling satisfying both the row/column distribution and the diagonal condition. Therefore the set of all admissible (n) is exactly
[
\boxed{{,n\in\Bbb N:;9\mid n,}}.
]
