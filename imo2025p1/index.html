
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IMO 2025 P1 - Sunny Lines</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .tabs {
            display: flex;
            background: #e9ecef;
            border-bottom: 3px solid #667eea;
        }

        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .tab:hover {
            background: #dee2e6;
        }

        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .grid-container {
            display: flex;
            gap: 30px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        canvas {
            border: 2px solid #667eea;
            border-radius: 8px;
            background: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .controls {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .control-group {
            margin: 15px 0;
        }

        .control-group label {
            font-weight: 600;
            display: block;
            margin-bottom: 8px;
        }

        input[type="number"], select {
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 1em;
            width: 150px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .insight-box {
            background: linear-gradient(135deg, #e7f3ff 0%, #f0f8ff 100%);
            border-left: 5px solid #667eea;
            padding: 25px;
            margin: 25px 0;
            border-radius: 8px;
        }

        .success-box {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 25px;
            margin: 25px 0;
            border-radius: 8px;
        }

        .warning-box {
            background: #fff5f5;
            border-left: 5px solid #dc3545;
            padding: 25px;
            margin: 25px 0;
            border-radius: 8px;
        }

        .legend {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-line {
            width: 40px;
            height: 3px;
        }

        .info-panel {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #e9ecef;
        }

        .construction-steps {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>IMO 2025 Problem 1: Sunny Lines</h1>
            <p style="font-size: 1.2em;">Interactive Visualization & Solution</p>
        </header>

        <div class="tabs">
            <div class="tab active" onclick="showTab('intro')">üìñ Introduction</div>
            <div class="tab" onclick="showTab('exploration')">üîç Exploration</div>
            <div class="tab" onclick="showTab('constructions')">üé® Constructions</div>
            <div class="tab" onclick="showTab('proof')">üìê Proof</div>
        </div>

        <div id="intro-tab" class="tab-content active">
            <h2 style="color: #667eea;">Problem Statement</h2>
            
            <div class="insight-box">
                <h3>Definition: Sunny Line</h3>
                <p style="font-size: 1.1em;">A line is <strong>sunny</strong> if it is NOT parallel to:</p>
                <ul style="margin-left: 30px; margin-top: 10px; font-size: 1.05em;">
                    <li>The x-axis (slope ‚â† 0)</li>
                    <li>The y-axis (slope ‚â† ‚àû)</li>
                    <li>The line x + y = 0 (slope ‚â† -1)</li>
                </ul>
            </div>

            <div class="insight-box">
                <h3>The Question</h3>
                <p style="font-size: 1.1em;">
                    Given n ‚â• 3, find all non-negative integers k such that there exist n distinct lines that:
                </p>
                <ol style="margin-left: 30px; margin-top: 10px; font-size: 1.05em;">
                    <li>Cover all points (a,b) where a,b are positive integers and a+b ‚â§ n+1</li>
                    <li>Exactly k of these lines are sunny</li>
                </ol>
            </div>

            <div class="controls">
                <div class="control-group">
                    <label>Value of n:</label>
                    <input type="number" id="intro-n" value="5" min="3" max="8">
                    <button onclick="updateIntroVisualization()">Update</button>
                </div>
            </div>

            <div class="grid-container">
                <div>
                    <h3>The Triangular Point Set</h3>
                    <canvas id="intro-canvas" width="400" height="400"></canvas>
                    <p style="margin-top: 10px;">Points (a,b) with a+b ‚â§ n+1 form a triangle</p>
                </div>
            </div>
        </div>

        <div id="exploration-tab" class="tab-content">
            <h2 style="color: #667eea;">Exploring Constructions</h2>

            <div class="insight-box">
                <h3>üéØ Goal</h3>
                <p style="font-size: 1.1em;">
                    For a given n, we need to find n lines that cover all points in the triangle.
                    Then determine: What values of k (number of sunny lines) are possible?
                </p>
            </div>

            <div class="controls">
                <div class="control-group">
                    <label>Value of n:</label>
                    <input type="number" id="explore-n" value="5" min="3" max="8">
                </div>
                <div class="control-group">
                    <label>Construction type:</label>
                    <select id="construction-type" onchange="updateExploration()">
                        <option value="k0">k = 0 (all vertical)</option>
                        <option value="k1">k = 1 (one sunny)</option>
                        <option value="k3">k = 3 (three sunny)</option>
                        <option value="custom">Custom</option>
                    </select>
                </div>
                <button onclick="updateExploration()">Update</button>
            </div>

            <div class="legend">
                <div class="legend-item">
                    <div class="legend-line" style="background: #28a745;"></div>
                    <span>Sunny lines</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line" style="background: #dc3545;"></div>
                    <span>Non-sunny lines</span>
                </div>
                <div class="legend-item">
                    <div style="width: 10px; height: 10px; background: #667eea; border-radius: 50%;"></div>
                    <span>Points to cover</span>
                </div>
            </div>

            <div class="grid-container">
                <canvas id="explore-canvas" width="500" height="500"></canvas>
                <div class="info-panel" id="explore-info">
                    <h3>Construction Details</h3>
                    <p id="construction-description"></p>
                </div>
            </div>
        </div>

        <div id="constructions-tab" class="tab-content">
            <h2 style="color: #667eea;">Key Constructions</h2>

            <div class="success-box">
                <h3>‚úì k = 0 Always Works</h3>
                <p style="font-size: 1.05em;">Use n vertical lines: x = 1, x = 2, ..., x = n</p>
                <p style="margin-top: 10px;">All lines are non-sunny (vertical), so k = 0.</p>
            </div>

            <div class="success-box">
                <h3>‚úì k = 1 Always Works</h3>
                <p style="font-size: 1.05em;">Start with k=0 construction, rotate the last line to make it sunny</p>
                <p style="margin-top: 10px;">Now we have 1 sunny line and n-1 non-sunny lines, so k = 1.</p>
            </div>

            <div class="success-box">
                <h3>‚úì k = 3 Always Works</h3>
                <p style="font-size: 1.05em;">Use three sunny lines for the base case (n=3), then extend with diagonal non-sunny lines</p>
                <p style="margin-top: 10px;">This construction generalizes to all n ‚â• 3.</p>
            </div>

            <div class="warning-box">
                <h3>‚úó k = 2 Never Works</h3>
                <p style="font-size: 1.05em;">Proven by contradiction using bijection argument</p>
                <p style="margin-top: 10px;">For n=3, you can verify by exhaustion. For n‚â•4, use downward induction.</p>
            </div>

            <div class="construction-steps">
                <h3>Interactive Constructor</h3>
                <div class="controls">
                    <button onclick="showConstruction(0)">Show k=0</button>
                    <button onclick="showConstruction(1)">Show k=1</button>
                    <button onclick="showConstruction(3)">Show k=3</button>
                </div>
                <canvas id="construction-canvas" width="500" height="500"></canvas>
            </div>
        </div>

        <div id="proof-tab" class="tab-content">
            <h2 style="color: #667eea;">Complete Proof</h2>

            <div class="insight-box">
                <h3>üéØ Answer: k ‚àà {0, 1, 3} for all n ‚â• 3</h3>
            </div>

            <div class="success-box">
                <h3>Strategy: Downward Induction</h3>
                <p style="font-size: 1.05em; line-height: 1.8;">
                    <strong>Key Claim:</strong> In any valid covering with n lines (n ‚â• 4), at least one of the following must be present:
                </p>
                <ul style="margin-left: 30px; margin-top: 10px;">
                    <li>The line x = 1 (leftmost vertical)</li>
                    <li>The line y = 1 (bottom horizontal)</li>
                    <li>The line x + y = n + 1 (outermost diagonal)</li>
                </ul>
            </div>

            <div class="success-box">
                <h4>Proof of Key Claim (by contradiction)</h4>
                <p style="margin: 15px 0;">Suppose none of these three lines are in the covering.</p>
                
                <p style="margin: 15px 0;"><strong>Step 1:</strong> Since x=1 is not in the covering, no two points with x-coordinate 1 can share the same line.</p>
                
                <p style="margin: 15px 0;"><strong>Step 2:</strong> There are n points with x=1, and n lines total. So the lines are in bijection with these points.</p>
                
                <p style="margin: 15px 0;"><strong>Step 3:</strong> By the same argument, the n lines are also in bijection with:
                    <ul style="margin-left: 30px;">
                        <li>Points with y=1 (bottom edge)</li>
                        <li>Points with x+y=n+1 (diagonal edge)</li>
                    </ul>
                </p>
                
                <p style="margin: 15px 0;"><strong>Step 4:</strong> Consider any interior point P (not on the three edges). The line L through P must also pass through one point from each of the three edges.</p>
                
                <p style="margin: 15px 0;"><strong>Step 5:</strong> But three points not all on the same edge cannot be collinear (they form a triangle)! This is a contradiction unless all three points are the corners.</p>
                
                <p style="margin: 15px 0;"><strong>Step 6:</strong> This means there's only one valid choice for L. But there are at least two interior points for n‚â•4, leading to a contradiction in the bijection.</p>
            </div>

            <div class="success-box">
                <h4>Completing the Induction</h4>
                <p style="margin: 15px 0;">Once we have the claim, we can:</p>
                <ol style="margin-left: 30px;">
                    <li>Remove one of the three boundary lines and all points on it</li>
                    <li>Get a valid covering for n-1 with the same number of sunny lines</li>
                    <li>This shows: valid k for n ‚äÜ valid k for n-1</li>
                    <li>Repeating: valid k for any n ‚äÜ valid k for n=3</li>
                    <li>For n=3, we can verify k ‚àà {0, 1, 3} by construction and k=2 is impossible</li>
                    <li>Since we have constructions for k ‚àà {0, 1, 3} for all n, the answer is exactly {0, 1, 3}</li>
                </ol>
            </div>

            <div class="insight-box">
                <h3>Visual Proof Helper</h3>
                <p>Select n to see the reduction visually:</p>
                <div class="controls">
                    <input type="number" id="proof-n" value="5" min="4" max="8">
                    <button onclick="showProofReduction()">Show Reduction</button>
                </div>
                <div style="display: flex; gap: 20px; margin-top: 20px;">
                    <div>
                        <h4>Before (n lines)</h4>
                        <canvas id="proof-before" width="400" height="400"></canvas>
                    </div>
                    <div style="display: flex; align-items: center; font-size: 2em;">‚Üí</div>
                    <div>
                        <h4>After (n-1 lines)</h4>
                        <canvas id="proof-after" width="400" height="400"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        // Generate points for the triangle
        function getPoints(n) {
            const points = [];
            for (let a = 1; a <= n; a++) {
                for (let b = 1; b <= n; b++) {
                    if (a + b <= n + 1) {
                        points.push({x: a, y: b});
                    }
                }
            }
            return points;
        }

        // Check if a line is sunny
        function isSunny(line) {
            if (line.type === 'vertical') return false;
            if (line.type === 'horizontal') return false;
            if (line.slope === -1) return false;
            return true;
        }

        // Draw grid and points
        function drawGrid(canvas, n, lines = [], highlightPoints = true) {
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            const padding = 50;
            const scale = Math.min((width - 2 * padding) / (n + 1), (height - 2 * padding) / (n + 1));

            ctx.clearRect(0, 0, width, height);

            // Convert point to canvas coordinates
            function toCanvas(x, y) {
                return {
                    x: padding + x * scale,
                    y: height - padding - y * scale
                };
            }

            // Draw axes
            ctx.strokeStyle = '#ddd';
            ctx.lineWidth = 1;
            ctx.beginPath();
            const origin = toCanvas(0, 0);
            const xEnd = toCanvas(n + 1, 0);
            const yEnd = toCanvas(0, n + 1);
            ctx.moveTo(origin.x, origin.y);
            ctx.lineTo(xEnd.x, xEnd.y);
            ctx.moveTo(origin.x, origin.y);
            ctx.lineTo(yEnd.x, yEnd.y);
            ctx.stroke();

            // Draw grid lines
            for (let i = 0; i <= n + 1; i++) {
                ctx.beginPath();
                const p1 = toCanvas(i, 0);
                const p2 = toCanvas(i, n + 1);
                ctx.moveTo(p1.x, p1.y);
                ctx.lineTo(p2.x, p2.y);
                ctx.stroke();

                ctx.beginPath();
                const p3 = toCanvas(0, i);
                const p4 = toCanvas(n + 1, i);
                ctx.moveTo(p3.x, p3.y);
                ctx.lineTo(p4.x, p4.y);
                ctx.stroke();
            }

            // Draw lines
            lines.forEach(line => {
                ctx.strokeStyle = isSunny(line) ? '#28a745' : '#dc3545';
                ctx.lineWidth = 3;
                ctx.beginPath();

                if (line.type === 'vertical') {
                    const p1 = toCanvas(line.x, 0);
                    const p2 = toCanvas(line.x, n + 1);
                    ctx.moveTo(p1.x, p1.y);
                    ctx.lineTo(p2.x, p2.y);
                } else if (line.type === 'horizontal') {
                    const p1 = toCanvas(0, line.y);
                    const p2 = toCanvas(n + 1, line.y);
                    ctx.moveTo(p1.x, p1.y);
                    ctx.lineTo(p2.x, p2.y);
                } else if (line.type === 'slope') {
                    // y = mx + b or x = cy + d
                    const points = [];
                    for (let x = 0; x <= n + 2; x += 0.1) {
                        const y = line.slope * x + line.intercept;
                        if (y >= 0 && y <= n + 2) {
                            points.push(toCanvas(x, y));
                        }
                    }
                    if (points.length > 0) {
                        ctx.moveTo(points[0].x, points[0].y);
                        points.forEach(p => ctx.lineTo(p.x, p.y));
                    }
                }
                ctx.stroke();
            });

            // Draw points
            if (highlightPoints) {
                const points = getPoints(n);
                points.forEach(p => {
                    const canvasP = toCanvas(p.x, p.y);
                    ctx.fillStyle = '#667eea';
                    ctx.beginPath();
                    ctx.arc(canvasP.x, canvasP.y, 5, 0, 2 * Math.PI);
                    ctx.fill();
                });
            }

            // Draw axis labels
            ctx.fillStyle = '#333';
            ctx.font = '12px sans-serif';
            for (let i = 1; i <= n; i++) {
                const p = toCanvas(i, 0);
                ctx.fillText(i, p.x - 5, p.y + 20);
                const p2 = toCanvas(0, i);
                ctx.fillText(i, p2.x - 20, p2.y + 5);
            }
        }

        // Constructions
        function getConstruction(n, k) {
            const lines = [];
            
            if (k === 0) {
                // All vertical lines
                for (let i = 1; i <= n; i++) {
                    lines.push({type: 'vertical', x: i});
                }
            } else if (k === 1) {
                // n-1 vertical, 1 sunny
                for (let i = 1; i < n; i++) {
                    lines.push({type: 'vertical', x: i});
                }
                lines.push({type: 'slope', slope: -2, intercept: n + 2});
            } else if (k === 3) {
                // Three sunny lines for base, rest diagonal
                lines.push({type: 'slope', slope: 2, intercept: -1});
                lines.push({type: 'slope', slope: 0.5, intercept: 0.5});
                lines.push({type: 'slope', slope: -2, intercept: 5});
                
                for (let i = 4; i <= n; i++) {
                    lines.push({type: 'slope', slope: -1, intercept: i});
                }
            }
            
            return lines;
        }

        // Update functions
        function updateIntroVisualization() {
            const n = parseInt(document.getElementById('intro-n').value);
            const canvas = document.getElementById('intro-canvas');
            drawGrid(canvas, n, [], true);
        }

        function updateExploration() {
            const n = parseInt(document.getElementById('explore-n').value);
            const type = document.getElementById('construction-type').value;
            const canvas = document.getElementById('explore-canvas');
            
            let k = 0;
            if (type === 'k1') k = 1;
            if (type === 'k3') k = 3;
            
            const lines = getConstruction(n, k);
            drawGrid(canvas, n, lines, true);
            
            const sunnyCount = lines.filter(l => isSunny(l)).length;
            const desc = document.getElementById('construction-description');
            desc.innerHTML = `
                <p><strong>Number of lines:</strong> ${lines.length}</p>
                <p><strong>Sunny lines:</strong> ${sunnyCount}</p>
                <p><strong>Non-sunny lines:</strong> ${lines.length - sunnyCount}</p>
                <p style="margin-top: 15px;">${getConstructionText(type)}</p>
            `;
        }

        function getConstructionText(type) {
            if (type === 'k0') return 'Using all vertical lines x = 1, 2, ..., n. All are non-sunny.';
            if (type === 'k1') return 'Using n-1 vertical lines and one sunny diagonal line.';
            if (type === 'k3') return 'Using three sunny lines plus diagonal non-sunny lines.';
            return '';
        }

        function showConstruction(k) {
            const n = 5;
            const canvas = document.getElementById('construction-canvas');
            const lines = getConstruction(n, k);
            drawGrid(canvas, n, lines, true);
        }

        function showProofReduction() {
            const n = parseInt(document.getElementById('proof-n').value);
            const canvasBefore = document.getElementById('proof-before');
            const canvasAfter = document.getElementById('proof-after');
            
            // Show k=1 construction
            const linesBefore = getConstruction(n, 1);
            drawGrid(canvasBefore, n, linesBefore, true);
            
            // Remove last line and show n-1
            const linesAfter = linesBefore.slice(0, -1);
            drawGrid(canvasAfter, n - 1, linesAfter, true);
        }

        // Initialize
        updateIntroVisualization();
        updateExploration();
        showConstruction(0);
        showProofReduction();
    </script>
</body>
</html>
